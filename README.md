Raw Material In/Out FormThis project provides a simple web form (HTML/CSS/JavaScript) for logging raw material movements (In/Out) and integrating with a Google Sheet as a backend using Google Apps Script.FeaturesResponsive UI: Designed with Tailwind CSS for optimal viewing on various devices.Timestamp Automation: Automatically records the submission timestamp.Dropdowns: Fixed dropdown options for Challan Type, Account Name, Outsource Process, and UOM.Searchable Dropdowns: Dynamic search functionality for Vendor Name and Raw Materials, pulling data from a Google Sheet."Other:" Input: Allows specifying custom values for "Outsource Process" and "UOM" when "Other:" is selected.Dynamic Raw Material Items: Add multiple raw material entries to a single form submission.Google Sheet Integration: Submits form data to a specified Google Sheet via Google Apps Script.Project Structure.
├── index.html          # The main web form (HTML, CSS, JavaScript)
├── Code.gs             # Google Apps Script code for backend logic
└── README.md           # This readme file
Setup GuideTo get this application running, you need to set up both the Google Sheet and the Google Apps Script, and then host the index.html file.Step 1: Prepare Your Google SheetCreate a New Google Sheet: Go to Google Sheets and create a new blank spreadsheet.Rename Sheets:Rename Sheet1 (or your first sheet) to Sheet1 (This will be your MASTER_SHEET_NAME for dropdown data).Create a new sheet and name it 1234 (This will be your DATA_ENTRY_SHEET_NAME where form submissions are logged).Record Spreadsheet ID: Copy the Spreadsheet ID from the Google Sheet URL. It's the long string of characters between /d/ and /edit (e.g., https://docs.google.com/spreadsheets/d/YOUR_SPREADSHEET_ID_HERE/edit). You will need this for Code.gs and index.html.Populate Dropdown Data (Master Sheet):In the Sheet1 (or your designated master sheet), populate:Column D: Your list of "Vendor Names" (starting from cell D2).Column Y: Your list of "Raw Materials" (starting from cell Y2).Ensure these columns contain the data you want to appear in your searchable dropdowns.Step 2: Set Up Google Apps ScriptOpen Apps Script Editor:From your Google Sheet (1234 sheet), go to Extensions > Apps Script.A new tab will open with the Apps Script editor.Paste Code.gs Content:Delete any existing code in Code.gs (usually an empty function myFunction() {}).Paste the entire content of the Code.gs file provided above into the Code.gs editor.Update Configuration in Code.gs:In Code.gs, update NEW_SPREADSHEET_ID with the Spreadsheet ID you copied in Step 1.const NEW_SPREADSHEET_ID = "YOUR_SPREADSHEET_ID_HERE"; // e.g., '1elkg5vbdzyaV09SejZW0PAWV_mfcFsJrqCrm76bl_mQ'
Ensure DATA_ENTRY_SHEET_NAME and MASTER_SHEET_NAME match the names you used in your Google Sheet.const DATA_ENTRY_SHEET_NAME = "1234";
const MASTER_SHEET_NAME = "Sheet1";
Verify SHEET_HEADERS_ORDER: Double-check that the SHEET_HEADERS_ORDER array in Code.gs exactly matches the intended column headers and their order in your 1234 Google Sheet. If your sheet is empty, Apps Script will create these headers on the first submission.Save the Script: Click the floppy disk icon (Save project) or Ctrl + S / Cmd + S.Deploy as Web App:Click Deploy (top right) > New deployment.Click the "Select type" dropdown and choose Web app.Configuration:Execute as: Select Me (your email address).Who has access: Select Anyone. (This is crucial for the web form to be able to submit data without requiring users to log in to your Google account.)Click Deploy.Authorize Access: The first time you deploy, you'll be prompted to authorize the script. Follow the prompts: select your Google account, click "Advanced" (or "Go to...") > "Go to [Project Name] (unsafe)" (this is safe as it's your own script) > "Allow".Copy Web App URL: After successful deployment, you will get a "Web app URL". Copy this URL. You will need it for index.html.Step 3: Update and Host index.htmlOpen index.html: Open the index.html file in a text editor.Update Apps Script URL: Paste the Web App URL you copied from Step 2 into the APPS_SCRIPT_URL constant.const APPS_SCRIPT_URL = 'YOUR_DEPLOYED_WEB_APP_URL_HERE'; // e.g., 'https://script.google.com/macros/s/AKfycbw1hqjtIMO6OLt7SyabLB-aXdHJQrUc7ox-fDuGYzs1himvD84h1s75cZc-GclMBI3Pzw/exec'
Update Spreadsheet ID (Optional but Recommended for Clarity): While the Apps Script uses its own configured ID, it's good practice to also ensure the SPREADSHEET_ID in index.html matches your actual spreadsheet ID for local testing/debugging purposes.const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE'; // Same as in Code.gs
Save index.html.Host the index.html:Local Testing: You can simply open index.html directly in your web browser (e.g., double-click it).Web Hosting: For public access, you'll need to host index.html on a web server (e.g., GitHub Pages, Netlify, Vercel, Firebase Hosting, Apache, Nginx).Testing Your ApplicationOpen index.html in your web browser.Fill out the form fields.Verify that "Vendor Name" and "Raw Materials" dropdowns populate from your Google Sheet. If not, check your Apps Script deployment and sheet names/columns.Select "Other:" for "Outsource Process" and "UOM" to ensure the custom input fields appear.Click "Submit Entry".Check your Google Sheet (1234 sheet). New rows should be appended with your form data.TroubleshootingForm Submission Fails:Check the browser's developer console (F12, then "Console" tab) for JavaScript errors.In the Apps Script editor, go to Executions (left sidebar) to see if your doPost function received the request and if there are any server-side errors.Ensure "Execute as: Me" and "Who has access: Anyone" are set correctly in your Apps Script deployment.Confirm APPS_SCRIPT_URL in index.html is exactly the Web App URL from your deployment.Dropdowns Not Loading:Check the browser's developer console for network errors during fetchDropdownData calls.In the Apps Script editor, check Executions for doGet calls. Verify they are running and not throwing errors.Ensure the sheet names (Sheet1, 1234) and column numbers (D and Y for master data) in Code.gs exactly match your Google Sheet setup.Confirm your master data sheets (Sheet1) have actual values in the specified columns starting from row 2.Headers Not Appearing/Incorrect:Ensure the SHEET_HEADERS_ORDER array in Code.gs precisely matches the column order you desire in your 1234 sheet.
